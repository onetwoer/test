define(["template","mobilebone"],function(a,b){window.template=a,window.Mobilebone=b,$.fn.serializeJSON=function(){{var a={},b=this.serializeArray();this.serialize()}return $(b).each(function(){a[this.name]?$.isArray(a[this.name])?a[this.name].push(this.value):a[this.name]=[a[this.name],this.value]:a[this.name]=this.value}),a};var c={};c.userCallback=function(b,d,e){var f=$(e.target),g=!("false"===f.attr("data-is-multiple")),h=$(".page.selector-user .mui-bar-nav"),i=$(".page.selector-user .mui-indexed-list").attr("data-is-multiple",g),j=i.attr("data-bind-event");i.height($(window).height()-h.height()),c.target=f,c.isMultiple=g,j||(i.attr("data-bind-event",!0),mui(".page.selector-user .mui-indexed-list").on("tap",".mui-checkbox",function(){var a=$(this).find("input"),b=!("false"===a.closest(".mui-indexed-list").attr("data-is-multiple"));b||(a.prop("checked",!0),"function"==typeof window.selectorUserCallback&&window.selectorUserCallback(window.selector))}),popup.showToast({message:"正在加载中...",type:"loading"}),$.when($.ajax({url:api.getSelectorUsers,dataType:"json",timeout:ajaxTimeout})).done(function(b){return popup.hideToast(),b.status?(i.find(".mui-indexed-list-inner .mui-table-view").html(a("users-tmpl",{data:b.data})),i.find(".mui-indexed-list-bar .list").html(a("users-indexed-tmpl",{data:b.data})),window.indexedList=new mui.IndexedList(i[0]),void(i.find(".mui-indexed-list-bar .list a").height()>20&&i.find(".mui-indexed-list-bar .list").addClass("fix"))):void popup.showToast({message:"获取用户信息失败。",type:"error"})}).fail(function(){popup.showToast({message:"获取用户信息失败。",type:"error"})}))},c.userFallback=function(){var a=$(".page.selector-user .mui-indexed-list .mui-checkbox input:checked");a.prop("checked",!1)},window.selector=c,$("html.mobilebone").size()>0&&Mobilebone.init()});